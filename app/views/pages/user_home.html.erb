<div class="container">
  <div class="row">
    <div class="col-xs-12">
      <div class="title">
        <h1>Hello <%= current_user.firstname %></h1>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-xs-12">
      <div class="index-search-bar">
        <h3>Recherche ta question</h3>

        <div class="row">
          <div class="ccol-xs-8 col-xs-offset-2">
            <div class="form-search">
              <span class="icon"><i class="fa fa-search"></i></span>
              <%= form_tag(questions_path, method: :get) do %>
                <%= text_field_tag :query, params[:query], class: 'form-control typeahead', id: "question_search", placeholder:"Recherche..." %>
                <%= submit_tag 'Shine!' , class: 'search-btn' %>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


  <div class="row">
    <div class="intro">
      <h3>Top Questions sur Shinier</h3>
      <p>Tourne la carte pour découvrir la réponse</p>
    </div>

    <div class="flip-results">

      <% @questions.each do |question| %>
        <div class="col-xs-4">
          <div class='flip-content'>
            <div class='flip_box'>

              <div class='front'>
                <div class="header-flip-card">
                  <h4 class='f_title'><%= question.title.first(20) %>...</h4>
                  <div class="picture-name">
                    <%= cl_image_tag question.user.photo, height: 50, width: 50, crop: :fill, class: "avatar-flip-card" %>
                    <p><%= question.user.firstname %></p>
                  </div>
                </div>
                <div class="middle-flip-card">
                  <p class='f_headline'>QUESTION</p>
                  <h4 class='f_subline'><%= question.body.first(50) %>...</h4>
                  <p>Le <%= question.created_at.strftime("%d/%m/%Y")%></p>
                </div>
                <div class="footer-flip-card">
                  <h4>Voir la réponse</h4>
                </div>
              </div>

              <div class='back'>
                <% top_answer = question.answers.sort_by do |answer| %>
                  <% -answer.get_upvotes.size %>
                <% end %>
                <div class="header-flip-card">
                  <h4 class='b_headline'>Meilleure réponse</h4>
                  <% if top_answer.blank? %>
                  <% else %>
                    <%= cl_image_tag top_answer.first.user.photo, height: 50, width: 50, crop: :fill, class: "avatar-flip-card" %>
                        <p><%= top_answer.first.user.firstname %></p>
                </div>

                <div class="middle-flip-card">
                  <p class='f_headline'>REPONSE</p>
                  <h4 class='f_subline'><%= top_answer.first.body.first(50) %>...</h4>
                  <p>Le <%= top_answer.first.created_at.strftime("%d/%m/%Y")%></p>
                  <% end %>
                </div>

                <div class="footer-flip-card">
                  <p class='b_text'>
                  <%= link_to question_path(question) do %>
                  <button class='b_button'><span>Voir plus</span></button>
                <% end %>
                </div>

              </div>

            </div>

            <div class='r_wrap'>
              <div class='b_round'></div>
              <div class='s_round'>
                <div class='s_arrow'></div>
              </div>
            </div>

          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
