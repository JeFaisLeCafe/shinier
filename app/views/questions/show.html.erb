<div class="container">
    <% top_answer = @question.answers.sort_by do |answer| %>
      <% -answer.get_upvotes.size %>
    <% end %>

    <div class="row">
      <div class="col-xs-10 col-xs-offset-1">
        <div class="question-big-box">
          <div class="question-pic-name">
            <%= cl_image_tag @question.user.photo, crop: :fill, class: "avatar-question-card" %>
              <h4><%= @question.user.firstname %></h4>
          </div>

          <div class="question-msg-show">
            <div class="question-msg-show-title-validation">
              <div class="question-msg-show-title">
                <h4><%= @question.title.capitalize %></h4>
              </div>
              <div class="validation">
                <% if @question.useful? %>
                  <p>SUPER QUESTION &nbsp;<i class="fas fa-rocket big-icon"></i></p>
                <% end %>
              </div>
            </div>

            <div class="div-question-msg-show-details">
              <p>Détails: <%= @question.body.capitalize %></p>
            </div>
            <div class="question-msg-show-date">
              <p>Le <%= @question.created_at.strftime("%d/%m/%Y")%></p>
            </div>
            <div id='tag_cloud'>
              <% tag_cloud Question.tag_counts, %w{s m l} do |tag| %>
                <%= link_to tag.name, tag_path(tag.name)%>
              <% end %>
            </div>
          </div>
          <div class="resolue">
            <% if current_user == @question.user %>
              <% if @question.answered == false %>
                <%= link_to 'Résolue?', question_toggle_path(@question), class: "btn-tag" %>
              <% else %>
                <h4> <i class="fas fa-crown big-icon"></i> &nbsp; Résolue!</h4>
              <% end %>
            <% else %>
              <% if @question.answered == false %>
                <h4><i id="need" class="fas fa-ambulance"></i> &nbsp; Besoin de réponses !</h4>
              <% else %>
                <h4> <i class="fas fa-crown big-icon"></i> &nbsp; Résolue!</h4>
              <% end %>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="results">
        <div class="col-xs-12">
          <div class="question-message-show">
            <div class="question-content">
              <div class="question-short">
                <div class="question-assets">
                  <div class="question-title-resolue">
                    <div class="question-title">

                    </div>
                  </div>

                  <div class="question-details">

                  </div>

                  <div class="validation">

                  </div>
  <!--
                  <#% if policy(Answer).create? %>
                    <#%= link_to "Rejoins la conversation avec ta réponse", new_question_answer_path(@question) %>
                  <#% end %> -->
                </div>
              </div>

              <div class="answers">
                <% if top_answer.blank? %>

                  <div class="upvotes">
                    <div class="arrow-top"></div>
                    <div class="counter">
                      <h4>0</h4>
                    </div>
                  </div>

                  <div class="top-answer">
                    <p>Meilleure réponse: pas encore donnée...</p>
                    <p>A toi de donner une nouvelle réponse ! <i class="far fa-smile big-icon"></i></p>
                  </div>

                <% else %>
                  <div class="upvotes" data-answer-id="<%= top_answer.first.id %>" >
                    <div class="arrow-top"></div>
                    <div class="counter">
                      <%= render "answers/counter", answer: top_answer.first %>
                    </div>
                  </div>

                  <div class="top-answer">
                    <p>Meilleure réponse par <%= top_answer.first.user.firstname %> le <%= top_answer.first.created_at.strftime("%d/%m/%Y") %></p>
                    <p><%= top_answer.first.body %></p>
                    <h6><%= link_to "Cette réponse te paraît inappropriée?", dislike_answer_path(top_answer), method: :put %></h6>
                  </div>
                <% end %>
              </div>

            </div>
          </div>
          <div class="answer-form">

            <%= render 'answers/form', question: @question, answer: @answer %>
            <%= paginate @answers %>
          </div>
          <div class="answers-container">
            <% @answers.each do |answer| %>
              <%= render "answers/show", answer: answer %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
